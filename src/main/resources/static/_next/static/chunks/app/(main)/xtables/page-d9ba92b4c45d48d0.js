(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5697],{2658:function(e,t,s){Promise.resolve().then(s.bind(s,6441))},6441:function(e,t,s){"use strict";s.r(t);var n=s(9268),a=s(8176),r=s(8298),o=s(6006),l=s(7932),c=s(9032),i=s(3575),d=s(7537),m=s(7389),u=s(6595);t.default=()=>{let{isConnected:e,lastConnectionUpdate:t,sendMessageAndWaitForCondition:s}=(0,o.useContext)(d.WebsocketContext),[p,h]=(0,o.useState)({}),[f,x]=(0,o.useState)(new Date),[v,b]=(0,o.useState)(new Date),g=(0,o.useRef)(null),[w,y]=(0,o.useState)([]),[j,S]=(0,o.useState)({}),[N,E]=(0,o.useState)(null),T=(0,o.useCallback)(t=>{let n=t.indexOf(" "),a=-1!==n?t.substring(0,n):t,r=t.split(" ");if(!e)return i.z.emit("response","Please connect to backend socket first!");if(!(null==p?void 0:p.connected))return i.z.emit("response","Please connect to XTABLES server first!");switch(a){case"help":case"ls":i.z.emit("response","Available Commands: - clear: Clear the terminal screen. - put {key} {value}: Update a specific key value. - get {key}: Retrieve a value from the server. - reboot: Reboots the XTABLES server. - delete {key}: Deletes a key and all data below. - help: Show available commands and their descriptions.");break;case"clear":i.z.emit("clear");break;case"put":r.length>=3?null!==(0,u.Z)(r[1])?i.z.emit("response",(0,u.Z)(r[1])):(i.z.emit("response","Sending put request..."),function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(r.slice(2).join(" "))?s({type:"XTABLES-DATA-PUT",message:JSON.stringify({value:r.slice(2).join(" "),key:r[1]})},e=>"XTABLES-DATA-PUT"===e.type).then(e=>{let t=e.message.code;i.z.emit("response","Server responded with: "+t)}).catch(e=>{i.z.emit("response","Failed to put data: "+e)}):i.z.emit("response","Invalid data structure!")):i.z.emit("response","Invalid command usage!");break;case"get":r.length>=2?null!==(0,u.Z)(r[1])?i.z.emit("response",(0,u.Z)(r[1])):(i.z.emit("response","Sending get request..."),s({type:"XTABLES-DATA-GET",message:r[1]},e=>"XTABLES-DATA-GET"===e.type).then(e=>{let t=e.message.code;i.z.emit("response","Server responded with: "+t)}).catch(e=>{i.z.emit("response","Failed to get data: "+e)})):i.z.emit("response","Invalid command usage!");break;case"delete":r.length>=2?null!==(0,u.Z)(r[1])?i.z.emit("response",(0,u.Z)(r[1])):(i.z.emit("response","Sending delete request..."),s({type:"XTABLES-DATA-DELETE",message:r[1]},e=>"XTABLES-DATA-DELETE"===e.type).then(e=>{let t=e.message.code;i.z.emit("response","Server responded with: "+t)}).catch(e=>{i.z.emit("response","Failed to delete data: "+e)})):i.z.emit("response","Invalid command usage!");break;case"reboot":(0,l.V)({message:"Are you sure you want to reboot?",header:"Reboot Confirmation",icon:"pi pi-exclamation-triangle",defaultFocus:"accept",accept(){i.z.emit("response","Rebooting server. Please wait."),s({type:"XTABLES-REBOOT"},e=>"XTABLES-REBOOT"===e.type).then(e=>{let t=e.message.code;i.z.emit("response","Server responded with: "+t)}).catch(e=>{i.z.emit("response","Failed to reboot server: "+e)})},reject(){i.z.emit("response","Cancelled reboot.")}});break;default:i.z.emit("response","Unknown command: "+a)}},[e,p]);(0,o.useEffect)(()=>{let t=setInterval(()=>{e&&s({type:"XTABLES-DATA"},e=>"XTABLES-DATA"===e.type).then(e=>{h(t=>(e.message.connected!==(null==t?void 0:t.connected)&&x(new Date),e.message.json!==(null==t?void 0:t.json)&&b(new Date),e.message)),S(JSON.parse(e.message.json)||{})}).catch(()=>{})},500);return()=>clearInterval(t)},[e,s]),(0,o.useEffect)(()=>(i.z.on("command",T),()=>{i.z.off("command",T)}),[T]),(0,o.useEffect)(()=>{y(function(e){let t=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.entries(e).map(e=>{let[n,a]=e,r={key:s?"".concat(s,".").concat(n):n,name:n};return"object"==typeof a&&null!==a?(a.hasOwnProperty("value")&&(r.value=a.value,r.type=(typeof JSON.parse(a.value)).toString()),a.data&&(r.data=t(a.data,r.key))):(r.value=a,r.type=(typeof JSON.parse(a)).toString()),r})};return t(e)}(j))},[j]);let k=e=>e.data&&Object.keys(e.data).length>0,A=e=>(0,n.jsx)("div",{className:"p-3",children:(0,n.jsxs)(a.w,{showGridlines:!1,value:e.data,rowExpansionTemplate:A,onRowToggle:e=>E(e.data),selectionMode:"single",expandedRows:N,dataKey:"key",removableSort:!0,children:[(0,n.jsx)(r.s,{expander:k,style:{width:"5rem"}}),(0,n.jsx)(r.s,{field:"name",header:""}),(0,n.jsx)(r.s,{field:"value",header:"",frozen:!0,className:"font-bold max-w-1 overflow-hidden whitespace-nowrap"}),(0,n.jsx)(r.s,{field:"type",className:"capitalize max-w-1 overflow-hidden whitespace-nowrap"})]})});return(0,n.jsxs)("div",{className:"grid",children:[(0,n.jsx)(l.Q,{}),(0,n.jsx)("div",{className:"col-12 lg:col-6 xl:col-4",children:(0,n.jsxs)("div",{className:"card mb-0",children:[(0,n.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"block text-500 font-medium mb-3",children:"Backend Status"}),(0,n.jsxs)("div",{className:"text-900 font-medium text-xl",children:[" ",e?"Connected":"Disconnected"]})]}),(0,n.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,n.jsx)("i",{className:"pi pi-chevron-circle-up text-blue-500 text-xl"})})]}),(0,n.jsx)(m.Z,{date:t})]})}),(0,n.jsx)("div",{className:"col-12 lg:col-6 xl:col-4",children:(0,n.jsxs)("div",{className:"card mb-0",children:[(0,n.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"block text-500 font-medium mb-3",children:"XTABLES Status"}),(0,n.jsx)("div",{className:"text-900 font-medium text-xl",children:e&&(null==p?void 0:p.connected)?"Connected":"Disconnected"})]}),(0,n.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,n.jsx)("i",{className:"pi pi-table text-blue-500 text-xl"})})]}),(0,n.jsx)(m.Z,{date:f})]})}),(0,n.jsx)("div",{className:"col-12 lg:col-6 xl:col-4",children:(0,n.jsxs)("div",{className:"card mb-0",children:[(0,n.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"block text-500 font-medium mb-3",children:"Data Size"}),(0,n.jsx)("div",{className:"text-900 font-medium text-xl",children:e&&(null==p?void 0:p.connected)?function(e){if("string"!=typeof e)throw TypeError("Input must be a string");let t=new Blob([e]).size;return t<1024?"".concat(t," bytes"):t<1048576?"".concat((t/1024).toFixed(2)," KB"):t<1073741824?"".concat((t/1048576).toFixed(2)," MB"):"".concat((t/1073741824).toFixed(2)," GB")}(null==p?void 0:p.json)||"Unknown":"Disconnected"})]}),(0,n.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,n.jsx)("i",{className:"pi pi-android text-cyan-500 text-xl"})})]}),(0,n.jsx)(m.Z,{date:v})]})}),(0,n.jsx)("div",{className:"col-12",children:(0,n.jsx)("div",{className:"card mb-0",children:(0,n.jsx)(c.o,{welcomeMessage:"Welcome to XTABLES control panel!",prompt:"XTABLES $",pt:{root:"bg-gray-900 text-white border-round",prompt:"text-gray-400 mr-2",command:"text-primary-300",response:"text-primary-300"}})})}),(0,n.jsx)("div",{className:"col-12",children:(0,n.jsx)("div",{className:"card mb-0",children:(0,n.jsxs)(a.w,{ref:g,value:w,selectionMode:"single",showGridlines:!1,globalFilterFields:["name","value"],removableSort:!0,filterDisplay:"row",expandedRows:N,onRowToggle:e=>E(e.data),loading:!e||!(null==p?void 0:p.connected),rowExpansionTemplate:A,dataKey:"key",scrollable:!0,scrollHeight:"50vh",tableStyle:{minWidth:"15rem"},children:[(0,n.jsx)(r.s,{expander:k,style:{width:"5rem"}}),(0,n.jsx)(r.s,{field:"name",header:"Name",sortable:!0,f:!0}),(0,n.jsx)(r.s,{field:"value",header:"Value",className:"font-bold max-w-1 overflow-hidden whitespace-nowrap",sortable:!0}),(0,n.jsx)(r.s,{field:"type",header:"Type",className:"capitalize max-w-1 overflow-hidden whitespace-nowrap",sortable:!0})]})})})]})}},7389:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var n=s(9268),a=s(6006);let r=e=>{let t=new Date-new Date(e),s=Math.floor(t/1e3),n=Math.floor(s/31536e3);return n>1?"".concat(n," years ago"):(n=Math.floor(s/2592e3))>1?"".concat(n," months ago"):(n=Math.floor(s/86400))>1?"".concat(n," days ago"):(n=Math.floor(s/3600))>1?"".concat(n," hours ago"):(n=Math.floor(s/60))>1?"".concat(n," minutes ago"):s>=1?"".concat(s," seconds ago"):t>1?"".concat(t," milliseconds ago"):"just now"};var o=e=>{let{date:t,className:s}=e,[o,l]=(0,a.useState)("");return(0,a.useEffect)(()=>{l(r(t));let e=setInterval(()=>{l(r(t))},100);return()=>clearInterval(e)},[t]),(0,n.jsx)("span",{className:s,children:o})}},7537:function(e,t,s){"use strict";s.r(t),s.d(t,{WebSocketProvider:function(){return o},WebsocketContext:function(){return r}});var n=s(9268),a=s(6006);let r=(0,a.createContext)({}),o=e=>{let{children:t,url:s}=e,[o,l]=(0,a.useState)(!1),[c,i]=(0,a.useState)(new Date),d=(0,a.useRef)(null);return(0,a.useEffect)(()=>((function e(){console.log("Connecting to websocket"),d.current=new WebSocket(s),d.current.onopen=()=>{l(!0)},d.current.onclose=()=>(l(!1),console.log("Disconnected from websocket."),e()),d.current.onerror=e=>{console.error("WebSocket Error: ",e),d.current.close(),l(!1)}})(),()=>{d.current&&d.current.close()}),[s]),(0,a.useEffect)(()=>{i(new Date)},[o]),(0,n.jsx)(r.Provider,{value:{isConnected:o,lastConnectionUpdate:c,sendMessageAndWaitForCondition:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1500;return o?(d.current.send(JSON.stringify(e)),new Promise((e,n)=>{let a=s=>{let n=JSON.parse(s.data);if(t(n)){d.current.removeEventListener("message",a),clearTimeout(r);let t=n.message;n.message=JSON.parse(t),e(n)}},r=setTimeout(()=>{d.current.removeEventListener("message",a),n(Error("Timeout: Condition not met within ".concat(s," ms")))},s);d.current.addEventListener("message",a)})):Promise.reject(Error("WebSocket is not connected"))}},children:t})}},6595:function(e,t){"use strict";t.Z=function(e){if(null==e||""===e.trim())return"Key cannot be null or empty.";if(e.includes(" "))return"Key cannot contain spaces.";if(e.startsWith(".")||e.endsWith("."))return"Key cannot start or end with '.'";if(e.includes(".."))return"Key cannot contain multiple consecutive '.'";let t=e.split(".");for(let e of t)if(""===e.trim())return"Key contains empty part(s).";return null}}},function(e){e.O(0,[8123,434,6878,6789,8285,9683,9345,6986,9968,4959,4390,9626,9253,5769,1744],function(){return e(e.s=2658)}),_N_E=e.O()}]);
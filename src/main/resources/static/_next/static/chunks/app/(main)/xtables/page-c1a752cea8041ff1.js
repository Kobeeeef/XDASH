(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5697],{502:function(e,t,s){Promise.resolve().then(s.bind(s,6441))},6441:function(e,t,s){"use strict";s.r(t);var n=s(9268),a=s(8176),l=s(716),r=s(6006),o=s(9032),c=s(3575),i=s(7537),d=s(7389);t.default=()=>{let{isConnected:e,lastConnectionUpdate:t,sendMessageAndWaitForCondition:s}=(0,r.useContext)(i.WebsocketContext),[m,u]=(0,r.useState)({}),[x,h]=(0,r.useState)(new Date),[f,v]=(0,r.useState)(new Date),p=(0,r.useRef)(null),[b,j]=(0,r.useState)([]),[w,g]=(0,r.useState)({}),y=(0,r.useCallback)(t=>{let s=t.indexOf(" "),n=-1!==s?t.substring(0,s):t;if(t.split(" "),!e)return c.z.emit("response","Please connect to backend socket first!");switch(n){case"help":case"ls":c.z.emit("response","Available Commands: - clear: Clear the terminal screen. - put {key} {value}: Update a specific key value. - get {key}: Retrieve a value from the server. - sync: Syncs all data from server to refresh. - help: Show available commands and their descriptions.");break;case"clear":c.z.emit("clear")}},[e]);(0,r.useEffect)(()=>{let t=setInterval(()=>{e&&s({type:"XTABLES-STATUS"},e=>"XTABLES-STATUS"===e.type).then(e=>{u(t=>(e.message.connected!==(null==t?void 0:t.connected)&&h(new Date),e.message.clients!==(null==t?void 0:t.clients)&&v(new Date),e.message))}).catch(e=>{})},100);return()=>clearInterval(t)},[e,s]),(0,r.useEffect)(()=>(c.z.on("command",y),()=>{c.z.off("command",y)}),[y]),(0,r.useEffect)(()=>{j(function(e){let t=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.entries(e).map(e=>{let[n,a]=e,l={key:s?"".concat(s,".").concat(n):n,name:n};return"object"==typeof a&&null!==a?(a.hasOwnProperty("value")&&(l.value=a.value,l.type=(typeof JSON.parse(a.value)).toString()),a.data&&(l.data=t(a.data,l.key))):(l.value=a,l.type=(typeof JSON.parse(a)).toString()),l})};return t(e)}(w))},[w]);let N=e=>e.data&&Object.keys(e.data).length>0,S=e=>(0,n.jsx)("div",{className:"p-3",children:(0,n.jsxs)(a.w,{showGridlines:!0,value:e.data,editMode:"cell",expandedRows:expandedRows,rowExpansionTemplate:S,selectionMode:"single",dataKey:"key",removableSort:!0,children:[(0,n.jsx)(l.s,{expander:N,style:{width:"5rem"}}),(0,n.jsx)(l.s,{field:"name",header:"",sortable:!0}),(0,n.jsx)(l.s,{field:"value",header:"",frozen:!0,className:"font-bold max-w-1 overflow-hidden whitespace-nowrap",editor:textEditor,onCellEditComplete:onCellEditComplete,sortable:!0}),(0,n.jsx)(l.s,{field:"type",className:"capitalize max-w-1 overflow-hidden whitespace-nowrap",sortable:!0})]})});return(0,n.jsxs)("div",{className:"grid",children:[(0,n.jsx)("div",{className:"col-12 lg:col-6 xl:col-4",children:(0,n.jsxs)("div",{className:"card mb-0",children:[(0,n.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"block text-500 font-medium mb-3",children:"Backend Status"}),(0,n.jsxs)("div",{className:"text-900 font-medium text-xl",children:[" ",e?"Connected":"Disconnected"]})]}),(0,n.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,n.jsx)("i",{className:"pi pi-chevron-circle-up text-blue-500 text-xl"})})]}),(0,n.jsx)(d.Z,{date:t})]})}),(0,n.jsx)("div",{className:"col-12 lg:col-6 xl:col-4",children:(0,n.jsxs)("div",{className:"card mb-0",children:[(0,n.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"block text-500 font-medium mb-3",children:"XTABLES Status"}),(0,n.jsx)("div",{className:"text-900 font-medium text-xl",children:e&&(null==m?void 0:m.connected)?"Connected":"Disconnected"})]}),(0,n.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,n.jsx)("i",{className:"pi pi-table text-blue-500 text-xl"})})]}),(0,n.jsx)(d.Z,{date:x})]})}),(0,n.jsx)("div",{className:"col-12 lg:col-6 xl:col-4",children:(0,n.jsxs)("div",{className:"card mb-0",children:[(0,n.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"block text-500 font-medium mb-3",children:"Clients"}),(0,n.jsx)("div",{className:"text-900 font-medium text-xl",children:e&&(null==m?void 0:m.connected)?(null==m?void 0:m.clients)||"Unknown":"Disconnected"})]}),(0,n.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,n.jsx)("i",{className:"pi pi-android text-cyan-500 text-xl"})})]}),(0,n.jsx)(d.Z,{date:f})]})}),(0,n.jsx)("div",{className:"col-12",children:(0,n.jsx)("div",{className:"card mb-0",children:(0,n.jsx)(o.o,{welcomeMessage:"Welcome to XTABLES control panel!",prompt:"XTABLES $",pt:{root:"bg-gray-900 text-white border-round",prompt:"text-gray-400 mr-2",command:"text-primary-300",response:"text-primary-300"}})})}),(0,n.jsx)("div",{className:"col-12",children:(0,n.jsx)("div",{className:"card mb-0",children:(0,n.jsxs)(a.w,{ref:p,virtualScrollerOptions:{itemSize:50},value:b,selectionMode:"single",showGridlines:!1,globalFilterFields:["name","value"],removableSort:!0,filterDisplay:"row",loading:!e,rowExpansionTemplate:S,dataKey:"key",scrollable:!0,scrollHeight:"50vh",tableStyle:{minWidth:"15rem"},children:[(0,n.jsx)(l.s,{expander:N,style:{width:"5rem"}}),(0,n.jsx)(l.s,{field:"name",header:"Name",sortable:!0,f:!0}),(0,n.jsx)(l.s,{field:"value",header:"Value",className:"font-bold max-w-1 overflow-hidden whitespace-nowrap",sortable:!0}),(0,n.jsx)(l.s,{field:"type",header:"Type",className:"capitalize max-w-1 overflow-hidden whitespace-nowrap",sortable:!0})]})})})]})}},7389:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var n=s(9268),a=s(6006);let l=e=>{let t=new Date-new Date(e),s=Math.floor(t/1e3),n=Math.floor(s/31536e3);return n>1?"".concat(n," years ago"):(n=Math.floor(s/2592e3))>1?"".concat(n," months ago"):(n=Math.floor(s/86400))>1?"".concat(n," days ago"):(n=Math.floor(s/3600))>1?"".concat(n," hours ago"):(n=Math.floor(s/60))>1?"".concat(n," minutes ago"):s>=1?"".concat(s," seconds ago"):t>1?"".concat(t," milliseconds ago"):"just now"};var r=e=>{let{date:t,className:s}=e,[r,o]=(0,a.useState)("");return(0,a.useEffect)(()=>{o(l(t));let e=setInterval(()=>{o(l(t))},100);return()=>clearInterval(e)},[t]),(0,n.jsx)("span",{className:s,children:r})}},7537:function(e,t,s){"use strict";s.r(t),s.d(t,{WebSocketProvider:function(){return r},WebsocketContext:function(){return l}});var n=s(9268),a=s(6006);let l=(0,a.createContext)({}),r=e=>{let{children:t,url:s}=e,[r,o]=(0,a.useState)(!1),[c,i]=(0,a.useState)(new Date),d=(0,a.useRef)(null);return(0,a.useEffect)(()=>((function e(){console.log("Connecting to websocket"),d.current=new WebSocket(s),d.current.onopen=()=>{o(!0)},d.current.onclose=()=>(o(!1),console.log("Disconnected from websocket."),e()),d.current.onerror=e=>{console.error("WebSocket Error: ",e),d.current.close(),o(!1)}})(),()=>{d.current&&d.current.close()}),[s]),(0,a.useEffect)(()=>{i(new Date)},[r]),(0,n.jsx)(l.Provider,{value:{isConnected:r,lastConnectionUpdate:c,sendMessageAndWaitForCondition:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1500;return r?(d.current.send(JSON.stringify(e)),new Promise((e,n)=>{let a=s=>{let n=JSON.parse(s.data);if(t(n)){d.current.removeEventListener("message",a),clearTimeout(l);let t=n.message;n.message=JSON.parse(t),e(n)}},l=setTimeout(()=>{d.current.removeEventListener("message",a),n(Error("Timeout: Condition not met within ".concat(s," ms")))},s);d.current.addEventListener("message",a)})):Promise.reject(Error("WebSocket is not connected"))}},children:t})}}},function(e){e.O(0,[8123,434,6878,6789,8285,9683,6486,7633,6986,6324,4959,5307,9253,5769,1744],function(){return e(e.s=502)}),_N_E=e.O()}]);
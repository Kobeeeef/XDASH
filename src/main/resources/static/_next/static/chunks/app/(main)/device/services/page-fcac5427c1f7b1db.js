(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9467],{6087:function(e,t,s){Promise.resolve().then(s.bind(s,7208))},7208:function(e,t,s){"use strict";s.r(t);var n=s(9268),r=s(6006),a=s(7537),i=s(7389),l=s(3429),o=s(8176),c=s(8298),d=s(4046),u=s(6008),m=s(4390),v=s(3702),x=s(1975),h=s(7690);t.default=()=>{var e,t,s,f,g;let N=(0,r.useRef)(null),p=(0,u.useSearchParams)(),j=p.get("server"),[b,y]=(0,r.useState)(null),[E,w]=(0,r.useState)(!1),[S,C]=(0,r.useState)(!1),{isConnected:k,lastConnectionUpdate:T,sendMessageAndWaitForCondition:D,sendMessage:I,socket:O}=(0,r.useContext)(a.WebsocketContext),[P,R]=(0,r.useState)(new Date),[M,A]=(0,r.useState)({}),[L,V]=(0,r.useState)(!1),[W,F]=(0,r.useState)([]);function J(){k&&(w(!0),D({type:"DEVICE-SERVICES-DATA",message:b},e=>"DEVICE-SERVICES-DATA"===e.type).then(e=>{w(!1);let t=JSON.parse(e.message.services);F(t)}).catch(e=>{N.current.show({severity:"error",summary:"Failed to reload",detail:e}),w(!1)}))}return(0,r.useEffect)(()=>{y(j)},[j]),(0,r.useEffect)(()=>{let e=setInterval(()=>{k&&D({type:"DEVICE-DATA",message:b},e=>"DEVICE-DATA"===e.type).then(e=>{var t;(null==e?void 0:null===(t=e.message)||void 0===t?void 0:t.exists)?(A(e.message),V(!1)):(V(!0),A({}))}).catch(()=>{})},250);return()=>clearInterval(e)},[k,b]),(0,n.jsxs)("div",{className:"grid fadeIn",children:[(0,n.jsx)(d.F,{ref:N}),(0,n.jsx)(m.V,{header:"Machine Discovery Failed",modal:!1,visible:L,position:"top-right",style:{width:"50vw"},onHide:()=>{L&&V(!1)},closable:!1,draggable:!0,resizable:!1,children:(0,n.jsxs)("p",{className:"m-0",children:["The machine with the server name ",(0,n.jsx)("strong",{children:b})," was not found on the network running XCASTER. Please check your network connection, verify the machine is on and try again later."]})}),(0,n.jsx)("div",{className:"col-12 lg:col-6 sm:col-4 xl:col-3",children:(0,n.jsxs)("div",{className:"card mb-0",children:[(0,n.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"block text-500 font-medium mb-3",children:"Backend Status"}),(0,n.jsx)("div",{className:"text-900 font-medium text-xl "+(k?"text-green-600":"text-red-600 animate-pulse"),children:k?"Connected":"Disconnected"})]}),(0,n.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,n.jsx)("i",{className:"pi pi-chevron-circle-up text-blue-500 text-xl"})})]}),(0,n.jsx)(i.Z,{date:T})]})}),(0,n.jsx)("div",{className:"col-12 lg:col-6 sm:col-4 xl:col-3",children:(0,n.jsxs)("div",{className:"card mb-0",children:[(0,n.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"block text-500 font-medium mb-3",children:"Machine Server"}),(0,n.jsx)("div",{className:"text-900 font-medium text-xl "+(k&&b?(null==M?void 0:M.status)==="CONNECTED"?"text-green-600":(null==M?void 0:M.status)==="CONNECTING"?"animate-pulse-fast text-yellow-500":"animate-pulse text-red-600":"animate-pulse text-red-600"),children:k?null!=b?b:"Unknown":"Disconnected"})]}),(0,n.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,n.jsx)("i",{className:"pi pi-desktop text-blue-500 text-xl"})})]}),(0,n.jsx)(i.Z,{date:T})]})}),(0,n.jsx)("div",{className:"col-12 lg:col-6 xl:col-3",children:(0,n.jsxs)("div",{className:"card mb-0",children:[(0,n.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"block text-500 font-medium mb-3",children:"Hostname"}),(0,n.jsx)("div",{className:"text-900 font-medium text-xl "+(k&&b&&(null==M?void 0:M.hostname)?(null==M?void 0:M.status)==="CONNECTED"?"text-green-600":(null==M?void 0:M.status)==="CONNECTING"?"animate-pulse-fast text-yellow-500":"animate-pulse text-red-600":"animate-pulse text-red-600"),children:k&&null!==(e=null==M?void 0:M.hostname)&&void 0!==e?e:"Unknown"})]}),(0,n.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,n.jsx)("i",{className:"pi pi-address-book text-blue-500 text-xl"})})]}),(0,n.jsx)(i.Z,{date:P})]})}),(0,n.jsx)("div",{className:"col-12 lg:col-6 xl:col-3",children:(0,n.jsxs)("div",{className:"card mb-0",children:[(0,n.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"block text-500 font-medium mb-3",children:"IP Address"}),(0,n.jsx)("div",{className:"text-900 font-medium text-xl "+(k&&b&&(null==M?void 0:M.address)?(null==M?void 0:M.status)==="CONNECTED"?"text-green-600":(null==M?void 0:M.status)==="CONNECTING"?"animate-pulse-fast text-yellow-500":"animate-pulse text-red-600":"animate-pulse text-red-600"),children:k&&null!==(t=null==M?void 0:M.address)&&void 0!==t?t:"Unknown"})]}),(0,n.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,n.jsx)("i",{className:"pi pi-map-marker text-blue-500 text-xl"})})]}),(0,n.jsx)(i.Z,{date:P})]})}),(0,n.jsx)("div",{className:"col-12",children:(0,n.jsx)("div",{className:"card mb-0",children:(0,n.jsxs)(o.w,{emptyMessage:(g=E?"Requesting resources":k?(null==M?void 0:M.exists)?(null==M?void 0:M.status)!=="CONNECTED"?"Connecting to machine":"No resources found":"Machine not running XCASTER":"Connecting to backend",(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,n.jsx)(h.E,{className:(null==M?void 0:M.status)==="CONNECTING"?"animate-pulse-fast":"animate-pulse",alt:"XBOT ROBOTICS LOGO",src:"/images/logo/logo.png"}),(0,n.jsxs)("p",{className:"font-bold",children:[g,(0,n.jsx)(x.Z,{delay:400})]})]})),value:!E&&0!==(null!=W?W:[]).length&&k&&(null==M?void 0:M.status)==="CONNECTED"&&(null==M?void 0:M.exists)?W:[],paginator:!0,rows:5,rowsPerPageOptions:[5,10,25,50,75],tableStyle:{minWidth:"50rem"},paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} to {last} of {totalRecords}",paginatorLeft:()=>(0,n.jsx)(v.z,{disabled:!k||(null==M?void 0:M.status)!=="CONNECTED",loading:E||S,type:"button",icon:"pi pi-refresh",text:!0,onClick:J}),children:[(0,n.jsx)(c.s,{filter:!0,field:"id",frozen:!0,header:"Name",style:{width:"16%"}},"id"),(0,n.jsx)(c.s,{filter:!0,field:"execMainPID",header:"PID",style:{width:"16%"}},"execMainPID"),(0,n.jsx)(c.s,{filter:!0,body:e=>(0,n.jsx)(l.V,{className:(null==e?void 0:e.activeState)==="active"?"glow-green-weak":(null==e?void 0:e.activeState)==="inactive"?"animate-pulse":(null==e?void 0:e.activeState)==="activating"||(null==e?void 0:e.activeState)==="reloading"||(null==e?void 0:e.activeState)==="maintenance"?"animate-pulse-fast":"",severity:(null==e?void 0:e.activeState)==="active"?"success":(null==e?void 0:e.activeState)==="inactive"?"danger":(null==e?void 0:e.status)==="activating"||(null==e?void 0:e.activeState)==="reloading"||(null==e?void 0:e.activeState)==="maintenance"?"warning":"danger",value:null!==(s=null==e?void 0:e.activeState)&&void 0!==s?s:"Unknown",rounded:!0}),header:"Status",style:{width:"16%"}},"status"),(0,n.jsx)(c.s,{body:e=>(0,n.jsx)("span",{children:(null==e?void 0:e.memoryCurrent)===0?"Unknown":null!==(f=null==e?void 0:e.memoryCurrent)&&void 0!==f?f:"Unknown"}),header:"Memory",style:{width:"16%"}},"memory"),(0,n.jsx)(c.s,{field:"cpuUsageNSec",header:"CPU",style:{width:"16%"}},"cpu"),(0,n.jsx)(c.s,{field:"execMainStartTimestamp",header:"Timestamp",style:{width:"16%"}},"timestamp"),(0,n.jsx)(c.s,{header:"Restart",body:e=>(0,n.jsx)(v.z,{className:"text-red-500",loading:E||S,disabled:!k||"active"!==e.activeState||(null==M?void 0:M.status)!=="CONNECTED",icon:"pi pi-sync",text:!0,onClick:()=>(function(e){if(!b){N.current.show({severity:"error",summary:"Server Not Found!",detail:"The server was not found."});return}if(!e){N.current.show({severity:"error",summary:"Service Not Found!",detail:"The service was not found."});return}C(!0),D({type:"DEVICE-SERVICE-RESTART",message:JSON.stringify({server:b,serviceID:e})},e=>"DEVICE-SERVICE-RESTART"===e.type,1e4).then(e=>{C(!1),N.current.show({severity:"success",summary:"Service Daemon Restarted!",detail:"The service has been restarted."}),J()}).catch(e=>{let t=e.message||"An unexpected error occurred.";N.current.show({severity:"error",summary:"Failed to restart",detail:t}),C(!1),J()})})(e.id)})},"restart")]})})})]})}},1975:function(e,t,s){"use strict";var n=s(9268),r=s(6006),a=s(9497),i=s.n(a);let l=e=>{let{delay:t=500}=e,[s,a]=(0,r.useState)("");return(0,r.useEffect)(()=>{let e=setInterval(()=>{a(e=>{switch(e){case"":return".";case".":return"..";case"..":return"...";default:return""}})},t);return()=>clearInterval(e)},[t]),(0,n.jsx)("span",{children:s})};l.propTypes={delay:i().number},t.Z=l},7389:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var n=s(9268),r=s(6006);let a=e=>{let t=new Date-new Date(e),s=Math.floor(t/1e3),n=Math.floor(s/31536e3);return n>1?"".concat(n," years ago"):(n=Math.floor(s/2592e3))>1?"".concat(n," months ago"):(n=Math.floor(s/86400))>1?"".concat(n," days ago"):(n=Math.floor(s/3600))>1?"".concat(n," hours ago"):(n=Math.floor(s/60))>1?"".concat(n," minutes ago"):s>=1?"".concat(s," seconds ago"):t>1?"".concat(t," milliseconds ago"):"just now"};var i=e=>{let{date:t,className:s}=e,[i,l]=(0,r.useState)("");return(0,r.useEffect)(()=>{l(a(t));let e=setInterval(()=>{l(a(t))},100);return()=>clearInterval(e)},[t]),(0,n.jsx)("span",{className:s,children:i})}},7537:function(e,t,s){"use strict";s.r(t),s.d(t,{WebSocketProvider:function(){return i},WebsocketContext:function(){return a}});var n=s(9268),r=s(6006);let a=(0,r.createContext)({}),i=e=>{let{children:t,url:s}=e,[i,l]=(0,r.useState)(!1),[o,c]=(0,r.useState)(new Date),d=(0,r.useRef)(null);return(0,r.useEffect)(()=>((function e(){console.log("Connecting to websocket"),d.current=new WebSocket(s),d.current.onopen=()=>{l(!0)},d.current.onclose=()=>(l(!1),console.log("Disconnected from websocket."),e()),d.current.onerror=e=>{console.error("WebSocket Error: ",e),d.current.close(),l(!1)}})(),()=>{d.current&&d.current.close()}),[s]),(0,r.useEffect)(()=>{c(new Date)},[i]),(0,n.jsx)(a.Provider,{value:{isConnected:i,lastConnectionUpdate:o,sendMessageAndWaitForCondition:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1500;return i?(d.current.send(JSON.stringify(e)),new Promise((e,n)=>{let r=s=>{let n=JSON.parse(s.data);if(t(n)){d.current.removeEventListener("message",r),clearTimeout(a);let t=n.message;n.message=JSON.parse(t),e(n)}},a=setTimeout(()=>{d.current.removeEventListener("message",r),n(Error("Timeout: Condition not met within ".concat(s," ms")))},s);d.current.addEventListener("message",r)})):Promise.reject(Error("WebSocket is not connected"))},sendMessageTillCondition:(e,t)=>{if(!i)throw Error("WebSocket is not connected");d.current.send(JSON.stringify(e));let s=e=>{let n=JSON.parse(e.data);t(n)&&d.current.removeEventListener("message",s)};d.current.addEventListener("message",s)},socket:d,sendMessage:e=>{if(!i)return Error("WebSocket is not connected");d.current.send(JSON.stringify(e))}},children:t})}},6008:function(e,t,s){e.exports=s(794)}},function(e){e.O(0,[8123,434,6878,6789,8285,9933,845,2087,7994,7136,4390,769,3210,9253,5769,1744],function(){return e(e.s=6087)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7974],{9164:function(e,t,s){Promise.resolve().then(s.bind(s,9852))},9852:function(e,t,s){"use strict";s.r(t);var r=s(9268),n=s(3702),i=s(8298),l=s(8176),o=s(6006),a=s(8671),c=s(3429),d=s(7537),u=s(7389),m=s(1975),v=s(4046),h=s(2723),x=s(6008);t.default=()=>{var e;let t=(0,o.useRef)(null),[s,f]=(0,o.useState)({}),[g,b]=(0,o.useState)({}),{layoutConfig:j}=(0,o.useContext)(a.V),{isConnected:N,lastConnectionUpdate:p,sendMessageAndWaitForCondition:y}=(0,o.useContext)(d.WebsocketContext),[S,w]=(0,o.useState)(!1),[E,C]=(0,o.useState)([]),[k,D]=(0,o.useState)(new Date),[T,M]=(0,o.useState)(new Date),[O,I]=(0,o.useState)([]),A=(0,x.useRouter)(),[P,L]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=setInterval(()=>{N&&y({type:"DEVICES-DATA"},e=>"DEVICES-DATA"===e.type).then(e=>{w(t=>{var s,r;return(null==e?void 0:null===(s=e.message)||void 0===s?void 0:s.xtablesConnectedStatus)!==t&&D(new Date),null===(r=e.message)||void 0===r?void 0:r.xtablesConnectedStatus}),I(t=>{var s,r;return null!==(r=null==e?void 0:null===(s=e.message)||void 0===s?void 0:s.logs)&&void 0!==r?r:[]}),C(t=>{var s,r;let n=JSON.parse(null!==(r=null==e?void 0:null===(s=e.message)||void 0===s?void 0:s.devices)&&void 0!==r?r:[]);return(null==n?void 0:n.length)!==(null==t?void 0:t.length)&&M(new Date),n})}).catch(()=>{})},100);return()=>clearInterval(e)},[N,y]);let R=()=>{b({plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}})},V=()=>{b({plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}})};return(0,o.useEffect)(()=>{"light"===j.colorScheme?R():V()},[j.colorScheme]),(0,r.jsxs)("div",{className:"grid fadeIn",children:[(0,r.jsx)(v.F,{ref:t}),(0,r.jsx)("div",{className:"col-12 lg:col-6 xl:col-3",children:(0,r.jsxs)("div",{className:"card mb-0",children:[(0,r.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"block text-500 font-medium mb-3",children:"Backend Status"}),(0,r.jsx)("div",{className:"text-900 font-medium text-xl",children:N?"Connected":"Disconnected"})]}),(0,r.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,r.jsx)("i",{className:"pi pi-chevron-circle-up text-blue-500 text-xl"})})]}),(0,r.jsx)(u.Z,{date:p})]})}),(0,r.jsx)("div",{className:"col-12 lg:col-6 xl:col-3",children:(0,r.jsxs)("div",{className:"card mb-0",children:[(0,r.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"block text-500 font-medium mb-3",children:"XTABLES Status"}),(0,r.jsx)("div",{className:"text-900 font-medium text-xl",children:N&&S?"Connected":"Disconnected"})]}),(0,r.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,r.jsx)("i",{className:"pi pi-table text-blue-500 text-xl"})})]}),(0,r.jsx)(u.Z,{date:k})]})}),(0,r.jsx)("div",{className:"col-12 lg:col-6 xl:col-3",children:(0,r.jsxs)("div",{className:"card mb-0",children:[(0,r.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"block text-500 font-medium mb-3",children:"Devices"}),(0,r.jsx)("div",{className:"text-900 font-medium text-xl",children:null!==(e=null==E?void 0:E.length)&&void 0!==e?e:0})]}),(0,r.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,r.jsx)("i",{className:"pi pi-android text-blue-500 text-xl"})})]}),(0,r.jsx)(u.Z,{date:T})]})}),(0,r.jsx)("div",{className:"col-12 lg:col-6 xl:col-3",children:(0,r.jsxs)("div",{className:"card mb-0",children:[(0,r.jsxs)("div",{className:"flex justify-content-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"block text-500 font-medium mb-3",children:"Notifications"}),(0,r.jsx)("div",{className:"text-900 font-medium text-xl",children:"0"})]}),(0,r.jsx)("div",{className:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"},children:(0,r.jsx)("i",{className:"pi pi-comment text-blue-500 text-xl"})})]}),(0,r.jsx)("span",{className:"text-green-500 font-bold",children:"1 "}),(0,r.jsx)("span",{className:"text-500",children:"minute ago"})]})}),(0,r.jsx)("div",{className:"col-12",children:(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)(l.w,{paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],paginatorLeft:()=>(0,r.jsx)(n.z,{icon:"pi pi-refresh",text:!0,loading:P,onClick:()=>{L(!0),y({type:"DEVICES-SEARCH"},e=>"DEVICES-SEARCH"===e.type,6e3).then(e=>{(null==e?void 0:e.message)==="OK"?t.current.show({severity:"success",summary:"Machine Discovered!",detail:"The mDNS has discovered new machines."}):t.current.show({severity:"error",summary:"Error Occurred.",detail:"The mDNS failed to discover services."}),L(!1)}).catch(e=>{let s=e.message||"An unexpected error occurred.";t.current.show({severity:"error",summary:"Error Occurred.",detail:s,life:5e3}),L(!1)})}}),removableSort:!0,loading:!N,value:E,emptyMessage:(0,r.jsxs)("p",{children:["Searching for machines running XCASTER",(0,r.jsx)(m.Z,{delay:200})]}),rows:5,paginator:!0,children:[(0,r.jsx)(i.s,{frozen:!0,field:"hostname",header:"Hostname",sortable:!0,style:{width:"25%"},body:e=>(0,r.jsx)("span",{className:"text-lg",children:e.hostname})}),(0,r.jsx)(i.s,{field:"server",header:"Server",style:{width:"25%"}}),(0,r.jsx)(i.s,{field:"address",header:"Address",style:{width:"25%"}}),(0,r.jsx)(i.s,{style:{width:"25%"},header:"Status",body:e=>(0,r.jsx)("div",{children:(0,r.jsx)(c.V,{className:(null==e?void 0:e.status)==="CONNECTING"?"animate-pulse-fast":(null==e?void 0:e.status)==="DISCONNECTED"?"animate-pulse":"",severity:e.connected?"success":(null==e?void 0:e.status)==="CONNECTED"?"success":(null==e?void 0:e.status)==="CONNECTING"?"warning":"danger",value:e.connected?"Connected":(null==e?void 0:e.status)==="CONNECTED"?"Connected":(null==e?void 0:e.status)==="CONNECTING"?"Connecting":"Disconnected",rounded:!0})})}),(0,r.jsx)(i.s,{header:"View",body:e=>(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.z,{loading:s[null==e?void 0:e.server],disabled:!N||(null==e?void 0:e.status)!=="CONNECTED",icon:"pi pi-search",text:!0,onClick:()=>{let s=null==e?void 0:e.server;if(!s){t.current.show({severity:"error",summary:"Server Not Found!",detail:"The server was not found."});return}f(e=>({...e,[s]:!0})),t.current.show({severity:"info",summary:"Redirecting...",detail:"You are being redirected to the machine control panel..."}),A.replace("/device/services?server="+s)}})})}),(0,r.jsx)(i.s,{header:"Control",body:e=>(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.z,{loading:s[null==e?void 0:e.server],disabled:!N||(null==e?void 0:e.status)!=="CONNECTED",icon:"pi pi-desktop",text:!0,onClick:()=>{let s=null==e?void 0:e.server;if(!s){t.current.show({severity:"error",summary:"Server Not Found!",detail:"The server was not found."});return}f(e=>({...e,[s]:!0})),t.current.show({severity:"info",summary:"Redirecting...",detail:"You are being redirected to the machine control panel..."}),A.replace("/device?server="+s)}})})}),(0,r.jsx)(i.s,{header:"Reboot",body:e=>(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.z,{loading:s[null==e?void 0:e.server],disabled:!N||(null==e?void 0:e.status)!=="CONNECTED",className:"text-red-500",icon:"pi pi-sync",text:!0,onClick:()=>{if(N){let s=null==e?void 0:e.server;if(!s){t.current.show({severity:"error",summary:"Server Not Found!",detail:"The server was not found."});return}f(e=>({...e,[s]:!0})),y({type:"DEVICE-REBOOT",message:s},e=>"DEVICE-REBOOT"===e.type,5e3).then(e=>{t.current.show({severity:"success",summary:"Server Rebooting!",detail:"The command was sent to the machine."}),f(e=>({...e,[s]:!1}))}).catch(()=>{t.current.show({severity:"error",summary:"Server Unresponsive!",detail:"The server did not respond in time."}),f(e=>({...e,[s]:!1}))})}}})})})]})})}),(0,r.jsx)("div",{className:"col-12",children:(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:"40rem"},children:O.map((e,t)=>(0,r.jsx)(h.Z,{log:e},t))})})})]})}},1975:function(e,t,s){"use strict";var r=s(9268),n=s(6006),i=s(9497),l=s.n(i);let o=e=>{let{delay:t=500}=e,[s,i]=(0,n.useState)("");return(0,n.useEffect)(()=>{let e=setInterval(()=>{i(e=>{switch(e){case"":return".";case".":return"..";case"..":return"...";default:return""}})},t);return()=>clearInterval(e)},[t]),(0,r.jsx)("span",{children:s})};o.propTypes={delay:l().number},t.Z=o},7389:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(9268),n=s(6006);let i=e=>{let t=new Date-new Date(e),s=Math.floor(t/1e3),r=Math.floor(s/31536e3);return r>1?"".concat(r," years ago"):(r=Math.floor(s/2592e3))>1?"".concat(r," months ago"):(r=Math.floor(s/86400))>1?"".concat(r," days ago"):(r=Math.floor(s/3600))>1?"".concat(r," hours ago"):(r=Math.floor(s/60))>1?"".concat(r," minutes ago"):s>=1?"".concat(s," seconds ago"):t>1?"".concat(t," milliseconds ago"):"just now"};var l=e=>{let{date:t,className:s}=e,[l,o]=(0,n.useState)("");return(0,n.useEffect)(()=>{o(i(t));let e=setInterval(()=>{o(i(t))},100);return()=>clearInterval(e)},[t]),(0,r.jsx)("span",{className:s,children:l})}},8671:function(e,t,s){"use strict";s.d(t,{V:function(){return i},a:function(){return l}});var r=s(9268),n=s(6006);let i=(0,n.createContext)({}),l=e=>{let{children:t}=e,[s,l]=(0,n.useState)({inputStyle:"outlined",menuMode:"static",colorScheme:"dark",theme:"lara-dark-indigo",scale:14}),[o,a]=(0,n.useState)({staticMenuDesktopInactive:!1,overlayMenuActive:!1,profileSidebarVisible:!1,configSidebarVisible:!1,staticMenuMobileActive:!1,menuHoverActive:!1}),c=()=>"overlay"===s.menuMode,d=()=>window.innerWidth>991;return(0,r.jsx)(i.Provider,{value:{layoutConfig:s,setLayoutConfig:l,layoutState:o,setLayoutState:a,onMenuToggle:()=>{c()&&a(e=>({...e,overlayMenuActive:!e.overlayMenuActive})),d()?a(e=>({...e,staticMenuDesktopInactive:!e.staticMenuDesktopInactive})):a(e=>({...e,staticMenuMobileActive:!e.staticMenuMobileActive}))},showProfileSidebar:()=>{a(e=>({...e,profileSidebarVisible:!e.profileSidebarVisible}))}},children:t})}},7537:function(e,t,s){"use strict";s.r(t),s.d(t,{WebSocketProvider:function(){return l},WebsocketContext:function(){return i}});var r=s(9268),n=s(6006);let i=(0,n.createContext)({}),l=e=>{let{children:t,url:s}=e,[l,o]=(0,n.useState)(!1),[a,c]=(0,n.useState)(new Date),d=(0,n.useRef)(null);return(0,n.useEffect)(()=>((function e(){console.log("Connecting to websocket"),d.current=new WebSocket(s),d.current.onopen=()=>{o(!0)},d.current.onclose=()=>(o(!1),console.log("Disconnected from websocket."),e()),d.current.onerror=e=>{console.error("WebSocket Error: ",e),d.current.close(),o(!1)}})(),()=>{d.current&&d.current.close()}),[s]),(0,n.useEffect)(()=>{c(new Date)},[l]),(0,r.jsx)(i.Provider,{value:{isConnected:l,lastConnectionUpdate:a,sendMessageAndWaitForCondition:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1500;return l?(d.current.send(JSON.stringify(e)),new Promise((e,r)=>{let n=s=>{let r=JSON.parse(s.data);if(t(r)){d.current.removeEventListener("message",n),clearTimeout(i);let t=r.message;r.message=JSON.parse(t),e(r)}},i=setTimeout(()=>{d.current.removeEventListener("message",n),r(Error("Timeout: Condition not met within ".concat(s," ms")))},s);d.current.addEventListener("message",n)})):Promise.reject(Error("WebSocket is not connected"))},sendMessageTillCondition:(e,t)=>{if(!l)throw Error("WebSocket is not connected");d.current.send(JSON.stringify(e));let s=e=>{let r=JSON.parse(e.data);t(r)&&d.current.removeEventListener("message",s)};d.current.addEventListener("message",s)},socket:d,sendMessage:e=>{if(!l)return Error("WebSocket is not connected");d.current.send(JSON.stringify(e))}},children:t})}},2723:function(e,t,s){"use strict";var r=s(9268);s(6006);var n=s(2153),i=s.n(n);let l=new(i())({fg:"#FFF",bg:"#000",newline:!0,escapeXML:!1,stream:!1}),o=e=>{var t,s;return l.toHtml(null!==(s=null==e?void 0:null===(t=e.replace("\x1b[?2004h","\x1b[92m"))||void 0===t?void 0:t.replace("\x1b[?2004l",""))&&void 0!==s?s:"")};t.Z=e=>{let{log:t}=e,s=o(t);return(0,r.jsx)("pre",{dangerouslySetInnerHTML:{__html:s}})}}},function(e){e.O(0,[8123,434,6878,6789,8285,9933,845,2087,7994,7136,4074,3210,9253,5769,1744],function(){return e(e.s=9164)}),_N_E=e.O()}]);